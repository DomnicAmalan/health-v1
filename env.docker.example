# Docker Compose Environment Variables
# Copy this to .env and customize as needed

# ============================================
# Database Configuration
# ============================================
POSTGRES_USER=auth_user
POSTGRES_PASSWORD=auth_password
POSTGRES_DB=auth_db
POSTGRES_PORT=5432
# Database connection pool limits (for 512MB RAM systems)
DATABASE_MAX_CONNECTIONS=5
DATABASE_MIN_CONNECTIONS=1

# ============================================
# Service Ports
# ============================================
API_SERVICE_PORT=8080
ADMIN_UI_PORT=5174
CLIENT_APP_PORT=5175
LOCALSTACK_PORT=4566
NATS_PORT=4225
NATS_HTTP_PORT=8225
NATS_CLUSTER_PORT=6225
KAFKA_PORT=9092
KAFKA_INTERNAL_PORT=29092
KAFKA_CONTROLLER_PORT=29093
KAFKA_UI_PORT=8081

# ============================================
# OpenBao Configuration
# ============================================
VAULT_ADDR=http://localhost:8200
VAULT_TOKEN=dev-root-token
VAULT_PORT=8200
VAULT_MOUNT_PATH=secret

# ============================================
# Auth Service Configuration
# ============================================
SERVER_HOST=0.0.0.0
SERVER_PORT=8080

# CORS Configuration (comma-separated list of allowed origins)
# Required when using credentials: 'include' (cookie-based auth)
CORS_ALLOWED_ORIGINS=http://localhost:5174,http://localhost:5173,http://localhost:5175

# Session Configuration
# App-specific session TTLs (in hours)
SESSION_ADMIN_UI_TTL_HOURS=8
SESSION_CLIENT_UI_TTL_HOURS=24
SESSION_API_TTL_HOURS=1
# Session cache size limit (for 512MB RAM systems)
SESSION_CACHE_MAX_ENTRIES=1000

# App-specific CORS origins (comma-separated)
CORS_ADMIN_UI_ORIGINS=http://localhost:5174
CORS_CLIENT_UI_ORIGINS=http://localhost:5175

# JWT Configuration (CHANGE IN PRODUCTION!)
JWT_SECRET=your-super-secret-jwt-key-change-in-production-min-32-chars

# OIDC Configuration
OIDC_ISSUER=http://localhost:8080
OIDC_CLIENT_ID=default-client
OIDC_CLIENT_SECRET=default-secret
JWT_EXPIRATION=3600

# KMS Configuration
KMS_PROVIDER=hashicorp

# Storage Configuration
STORAGE_PROVIDER=local

# Logging
LOG_LEVEL=info
RUST_LOG=info

# Deployment
DEPLOYMENT_ENV=development
CLOUD_PROVIDER=none

# ============================================
# Memory Optimization Settings (512MB RAM)
# ============================================
# Graph cache configuration
GRAPH_CACHE_ENABLED=true
GRAPH_CACHE_TTL_SECONDS=60

# Tokio runtime configuration
TOKIO_WORKER_THREADS=2

# Rust build configuration (for low-memory systems)
CARGO_BUILD_JOBS=2

# ============================================
# Service Enable Flags
# ============================================
ENABLE_POSTGRES=true
ENABLE_OPENBAO_SERVICE=true
ENABLE_LOCALSTACK=false
ENABLE_NATS=false
ENABLE_KAFKA=false
ENABLE_SONARQUBE=false

# ============================================
# Admin UI Configuration
# ============================================
ADMIN_UI_API_BASE_URL=http://localhost:8080
VITE_OIDC_ISSUER=http://localhost:8080
VITE_OIDC_CLIENT_ID=default-client
VITE_ENABLE_POSTGRES=true
VITE_ENABLE_OPENBAO_SERVICE=true
VITE_ENABLE_LOCALSTACK=false
VITE_ENABLE_NATS=false
VITE_ENABLE_KAFKA=false

# ============================================
# Client App Configuration
# ============================================
CLIENT_APP_API_BASE_URL=http://localhost:8080

# ============================================
# LocalStack Configuration
# ============================================
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=test
AWS_SECRET_ACCESS_KEY=test
LOCALSTACK_SERVICES=s3,kms
LOCALSTACK_DEBUG=1

# ============================================
# NATS Configuration
# ============================================
NATS_URL=nats://localhost:4225
NATS_ENABLE_JETSTREAM=true

# ============================================
# Kafka Configuration (KRaft mode)
# ============================================
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_PORT=9092
KAFKA_INTERNAL_PORT=29092
KAFKA_CONTROLLER_PORT=29093
KAFKA_UI_PORT=8081
# KRaft mode configuration
KAFKA_PROCESS_ROLES=broker,controller
KAFKA_NODE_ID=1
KAFKA_CONTROLLER_QUORUM_VOTERS=1@kafka:29093

# ============================================
# SonarQube Configuration
# ============================================
SONARQUBE_PORT=9000
SONARQUBE_VERSION=community
SONARQUBE_DB=sonar
SONAR_HOST_URL=http://localhost:9000
SONAR_TOKEN=
SONAR_ORGANIZATION=
# SonarQube Java options (for 512MB RAM systems)
SONAR_CE_JAVAOPTS=-Xmx512m -Xms128m
SONAR_WEB_JAVAOPTS=-Xmx512m -Xms128m
SONAR_ES_BOOTSTRAP_CHECKS_DISABLE=true

